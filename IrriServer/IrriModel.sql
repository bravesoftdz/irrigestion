/******************************************************************************/
/****      Generated by IBExpert 2015.6.1.1 09/01/2016 10:50:13 p.m.       ****/
/******************************************************************************/

SET NAMES ISO8859_1;

CREATE DATABASE 'C:\AppServer\GRANOS.FDB'
USER 'SYSDBA' PASSWORD 'auofdsbcss'
PAGE_SIZE 4096
DEFAULT CHARACTER SET ISO8859_1 COLLATION ISO8859_1;



/******************************************************************************/
/****                               Domains                                ****/
/******************************************************************************/

CREATE DOMAIN BOOLEANO AS
SMALLINT
CHECK (VALUE = 0 OR VALUE = 1);

CREATE DOMAIN CADENA030 AS
VARCHAR(30);

CREATE DOMAIN CADENA050 AS
VARCHAR(50);

CREATE DOMAIN CADENA250 AS
VARCHAR(250);

CREATE DOMAIN CARACTER AS
CHAR(1);

CREATE DOMAIN DOBLE AS
DOUBLE PRECISION;

CREATE DOMAIN ENTERO AS
INTEGER;

CREATE DOMAIN FECHA AS
DATE;

CREATE DOMAIN GUID AS
VARCHAR(38);

CREATE DOMAIN MEMO AS
BLOB SUB_TYPE 0 SEGMENT SIZE 80;



/******************************************************************************/
/****                                Tables                                ****/
/******************************************************************************/



CREATE TABLE CICLOS (
    ID_CICLO  GUID NOT NULL,
    NOMBRE    CADENA050
);


CREATE TABLE CULTIVOS (
    ID_CULTIVO  GUID NOT NULL,
    NOMBRE      CADENA050
);


CREATE TABLE DISTRITOS (
    ID_DISTRITO  GUID NOT NULL,
    NOMBRE       CADENA050
);


CREATE TABLE ESTACIONES (
    ID_ESTACION  GUID NOT NULL,
    ID_DISTRITO  GUID NOT NULL,
    NOMBRE       CADENA050
);


CREATE TABLE FENOLOGIAS (
    ID_FENOLOGIA  GUID NOT NULL,
    ORDEN         ENTERO,
    NOMBRE        CADENA050,
    CLAVE         CADENA050,
    DGC           DOBLE,
    ID_TIPO       GUID NOT NULL
);


CREATE TABLE HISTORICOS (
    ID_HISTORICO  GUID NOT NULL,
    ID_ESTACION   GUID NOT NULL,
    FECHA         FECHA,
    ETO           DOBLE,
    TEMP          DOBLE
);


CREATE TABLE LLUVIAS (
    ID_LLUVIA       GUID NOT NULL,
    FECHA           FECHA,
    ID_PLUVIOMETRO  GUID NOT NULL,
    PP              DOBLE
);


CREATE TABLE PARCELAS (
    ID_PARCELA      GUID NOT NULL,
    ID_DISTRITO     GUID,
    ID_ESTACION     GUID,
    NOMBRE          CADENA050,
    SUPERFICIE      DOBLE,
    ID_PLUVIOMETRO  GUID,
    UBICACION       CADENA050,
    HA              DOBLE,
    ID_USUARIO      GUID NOT NULL
);


CREATE TABLE PLUVIOMETROS (
    ID_PLUVIOMETRO  GUID NOT NULL,
    ALTITUD         DOBLE,
    ALTURA          DOBLE,
    LATITUD         DOBLE,
    LONGITUD        DOBLE,
    NOMBRE          CADENA050,
    UBICACION       CADENA050,
    ID_USUARIO      GUID NOT NULL
);


CREATE TABLE RIEGOS (
    ID_RIEGO    GUID NOT NULL,
    ID_SIEMBRA  GUID NOT NULL,
    INI         FECHA,
    HORAS       DOBLE,
    AVANCE      DOBLE,
    GASTO       DOBLE,
    LAMINA      DOBLE,
    NOTAS       BLOB SUB_TYPE 0 SEGMENT SIZE 80
);


CREATE TABLE SIEMBRAS (
    ID_SIEMBRA   GUID NOT NULL,
    ID_CULTIVO   GUID,
    FECHA        FECHA,
    NOMBRE       CADENA050,
    RENDIMIENTO  DOBLE,
    SUPERFICIE   DOBLE,
    ID_TIPO      GUID,
    ID_PARCELA   GUID NOT NULL,
    ID_VARIEDAD  GUID,
    GASTO        DOBLE,
    HUMEDAD      ENTERO,
    COSECHADA    BOOLEANO,
    EFICIENCIA   DOBLE,
    ID_CICLO     GUID
);


CREATE TABLE SISTEMAS (
    ID_SISTEMA  GUID NOT NULL,
    NOMBRE      CADENA050
);


CREATE TABLE SUBSISTEMAS (
    ID_SUBSISTEMA  GUID NOT NULL,
    NOMBRE         CADENA050,
    PROMEDIO       DOBLE,
    MAXIMO         DOBLE,
    UD             DOBLE,
    ID_SISTEMA     GUID NOT NULL
);


CREATE TABLE SUELOS (
    ID_SUELO  GUID NOT NULL,
    ARCILLA   DOBLE,
    ARENA     DOBLE,
    NOMBRE    CADENA050,
    MO        DOBLE,
    DA        DOBLE
);


CREATE TABLE TIPOS (
    ID_TIPO     GUID NOT NULL,
    ORDEN       ENTERO,
    ID_SISTEMA  GUID,
    NOMBRE      CADENA050,
    TUMIN       DOBLE,
    TUMAX       DOBLE,
    KMAX        DOBLE,
    KCO         DOBLE,
    XKMAX       DOBLE,
    PRO         DOBLE,
    PRMAX       DOBLE,
    ALPHA0      DOBLE,
    ALPHA1      DOBLE,
    ALPHA2      DOBLE,
    ALPHA3      DOBLE,
    ALPHA4      DOBLE,
    ALPHA5      DOBLE,
    ID_CULTIVO  GUID NOT NULL
);


CREATE TABLE USUARIOS (
    ID_USUARIO  GUID NOT NULL,
    NOMBRE      CADENA050,
    LOGIN       CADENA030,
    PASSWORD    CADENA250,
    ACTIVO      ENTERO
);


CREATE TABLE VARIEDADES (
    ID_VARIEDAD  GUID NOT NULL,
    NOMBRE       CADENA050,
    ID_TIPO      GUID NOT NULL
);




/******************************************************************************/
/****                             Primary keys                             ****/
/******************************************************************************/

ALTER TABLE CICLOS ADD CONSTRAINT PK_CICLOS PRIMARY KEY (ID_CICLO);
ALTER TABLE CULTIVOS ADD CONSTRAINT PK_CULTIVOS PRIMARY KEY (ID_CULTIVO);
ALTER TABLE DISTRITOS ADD CONSTRAINT PK_DISTRITOS PRIMARY KEY (ID_DISTRITO);
ALTER TABLE ESTACIONES ADD CONSTRAINT PK_ESTACIONES PRIMARY KEY (ID_ESTACION);
ALTER TABLE FENOLOGIAS ADD CONSTRAINT PK_FENOLOGIAS PRIMARY KEY (ID_FENOLOGIA);
ALTER TABLE HISTORICOS ADD CONSTRAINT PK_HISTORICOS PRIMARY KEY (ID_HISTORICO);
ALTER TABLE LLUVIAS ADD CONSTRAINT PK_LLUVIAS PRIMARY KEY (ID_LLUVIA);
ALTER TABLE PARCELAS ADD CONSTRAINT PK_PARCELAS PRIMARY KEY (ID_PARCELA);
ALTER TABLE PLUVIOMETROS ADD CONSTRAINT PK_PLUVIOMETROS PRIMARY KEY (ID_PLUVIOMETRO);
ALTER TABLE RIEGOS ADD CONSTRAINT PK_RIEGOS PRIMARY KEY (ID_RIEGO);
ALTER TABLE SIEMBRAS ADD CONSTRAINT PK_SIEMBRAS PRIMARY KEY (ID_SIEMBRA);
ALTER TABLE SISTEMAS ADD CONSTRAINT PK_SISTEMAS PRIMARY KEY (ID_SISTEMA);
ALTER TABLE SUBSISTEMAS ADD CONSTRAINT PK_SUBSISTEMAS PRIMARY KEY (ID_SUBSISTEMA);
ALTER TABLE SUELOS ADD CONSTRAINT PK_SUELOS PRIMARY KEY (ID_SUELO);
ALTER TABLE TIPOS ADD CONSTRAINT PK_TIPOS PRIMARY KEY (ID_TIPO);
ALTER TABLE USUARIOS ADD CONSTRAINT PK_USUARIOS PRIMARY KEY (ID_USUARIO);
ALTER TABLE VARIEDADES ADD CONSTRAINT PK_VARIEDADES PRIMARY KEY (ID_VARIEDAD);


/******************************************************************************/
/****                             Foreign keys                             ****/
/******************************************************************************/

ALTER TABLE ESTACIONES ADD CONSTRAINT FK_ESTACIONES_1 FOREIGN KEY (ID_DISTRITO) REFERENCES DISTRITOS (ID_DISTRITO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE FENOLOGIAS ADD CONSTRAINT FK_FENOLOGIAS_1 FOREIGN KEY (ID_TIPO) REFERENCES TIPOS (ID_TIPO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE HISTORICOS ADD CONSTRAINT FK_HISTORICOS_1 FOREIGN KEY (ID_ESTACION) REFERENCES ESTACIONES (ID_ESTACION) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE LLUVIAS ADD CONSTRAINT FK_LLUVIAS_1 FOREIGN KEY (ID_PLUVIOMETRO) REFERENCES PLUVIOMETROS (ID_PLUVIOMETRO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE PARCELAS ADD CONSTRAINT FK_PARCELAS_1 FOREIGN KEY (ID_DISTRITO) REFERENCES DISTRITOS (ID_DISTRITO) ON UPDATE CASCADE;
ALTER TABLE PARCELAS ADD CONSTRAINT FK_PARCELAS_2 FOREIGN KEY (ID_ESTACION) REFERENCES ESTACIONES (ID_ESTACION) ON UPDATE CASCADE;
ALTER TABLE PARCELAS ADD CONSTRAINT FK_PARCELAS_4 FOREIGN KEY (ID_PLUVIOMETRO) REFERENCES PLUVIOMETROS (ID_PLUVIOMETRO) ON UPDATE CASCADE;
ALTER TABLE PARCELAS ADD CONSTRAINT FK_PARCELAS_5 FOREIGN KEY (ID_USUARIO) REFERENCES USUARIOS (ID_USUARIO) ON UPDATE CASCADE;
ALTER TABLE PLUVIOMETROS ADD CONSTRAINT FK_PLUVIOMETROS_2 FOREIGN KEY (ID_USUARIO) REFERENCES USUARIOS (ID_USUARIO) ON UPDATE CASCADE;
ALTER TABLE RIEGOS ADD CONSTRAINT FK_RIEGOS_1 FOREIGN KEY (ID_SIEMBRA) REFERENCES SIEMBRAS (ID_SIEMBRA) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE SIEMBRAS ADD CONSTRAINT FK_SIEMBRAS_1 FOREIGN KEY (ID_CULTIVO) REFERENCES CULTIVOS (ID_CULTIVO) ON UPDATE CASCADE;
ALTER TABLE SIEMBRAS ADD CONSTRAINT FK_SIEMBRAS_3 FOREIGN KEY (ID_TIPO) REFERENCES TIPOS (ID_TIPO) ON UPDATE CASCADE;
ALTER TABLE SIEMBRAS ADD CONSTRAINT FK_SIEMBRAS_4 FOREIGN KEY (ID_PARCELA) REFERENCES PARCELAS (ID_PARCELA) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE SIEMBRAS ADD CONSTRAINT FK_SIEMBRAS_5 FOREIGN KEY (ID_VARIEDAD) REFERENCES VARIEDADES (ID_VARIEDAD) ON UPDATE CASCADE;
ALTER TABLE SIEMBRAS ADD CONSTRAINT FK_SIEMBRAS_6 FOREIGN KEY (ID_CICLO) REFERENCES CICLOS (ID_CICLO) ON UPDATE CASCADE;
ALTER TABLE SUBSISTEMAS ADD CONSTRAINT FK_SUBSISTEMAS_1 FOREIGN KEY (ID_SISTEMA) REFERENCES SISTEMAS (ID_SISTEMA) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE TIPOS ADD CONSTRAINT FK_TIPOS_1 FOREIGN KEY (ID_CULTIVO) REFERENCES CULTIVOS (ID_CULTIVO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE TIPOS ADD CONSTRAINT FK_TIPOS_2 FOREIGN KEY (ID_SISTEMA) REFERENCES SISTEMAS (ID_SISTEMA) ON UPDATE CASCADE;
ALTER TABLE VARIEDADES ADD CONSTRAINT FK_VARIEDADES_1 FOREIGN KEY (ID_TIPO) REFERENCES TIPOS (ID_TIPO) ON DELETE CASCADE ON UPDATE CASCADE;